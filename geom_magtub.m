%All functions together
function [Mkma,Mkba,Mkmc,Mkbc,Yma,Yba,Ymc,Ybc]=geom_magtub(a,c,T,acheck)

a_c=a./c;
a_T=a./T;
L_T=1.17;
a_2c=a./(2.*c);

% Magnification factor for a - Membrane only "M_kma"
if acheck<0.125
    Mkma = 1;
else
    g1a=-1.0343.*(a_c).^2-0.15657.*(a_c)+1.3409;
    g2a=1.3218.*(a_c).^(-0.61153);
    g3a=-0.87238.*(a_c)+1.2788;
    g4a=-0.4619.*(a_c).^3+0.6709.*(a_c).^2-0.37571.*(a_c)+4.6511;

f1a=0.43358.*(a_T).^(g1a+(g2a.*(a_T)).^g3a)+0.93163.*exp((a_T).^(-0.050966))+g4a;

f2a=-0.2151.*(1-a_T).^176.4199+2.8141.*(a_T).^(-0.10740.*a_T);

    g5a=-0.015647.*(L_T).^3+0.090887.*(L_T).^2-0.1718.*(L_T)-0.24587;
    g6a=-0.20136.*(L_T).^2+0.93311.*(L_T)-0.41496;
    g7a=0.20188.*(L_T).^2-0.97857.*(L_T)+0.068225;
    g8a=-0.027338.*(L_T).^2+0.12551.*(L_T)-11.218;

f3a=0.33994.*(a_T).^g5a+1.9493.*(a_T).^0.23003+(g6a.*(a_T).^2+g7a.*a_T+g8a);

Mkma=f1a+f2a+f3a;
end

% Magnification factor for a - Bending only "M_kba"
if acheck<0.125
    Mkba = 1;
else
    g1ab=-0.014992.*(a_c).^2-0.021401.*a_c-0.23851;
    g2ab=0.61775.*(a_c).^(-1.0278);
    g3ab=0.00013242.*a_c-1.4744;
    g4ab=-0.28783.*(a_c).^3+0.58706.*(a_c).^2-0.37198.*a_c-0.89887;

f1ab=0.065916.*(a_T).^(g1ab+(g2ab.*(a_T)).^g3ab)+0.52086.*exp((a_T).^(-0.10364))+g4ab;

    g5ab=-17.195.*(a_T).^2+12.468.*a_T-0.51662;
    
f2ab=-0.02195.*(1-a_T).^2.8113+0.021403.*(a_T).^(g5ab);

    g6ab=-0.0598.*(L_T).^3+0.38091.*(L_T).^2-0.8022.*(L_T)+0.31905;
    g7ab=-0.35848.*(L_T).^2+1.3975.*(L_T)-1.7535;
    g8ab=0.31288.*(L_T).^2-1.3599.*(L_T)+1.6611;
    g9ab=-0.00147.*(L_T).^2-0.0025074.*(L_T)-0.0089846;

f3ab=0.23344.*(a_T).^g6ab-0.14827.*(a_T).^(-0.20077)+(g7ab.*(a_T).^2+g8ab.*a_T+g9ab);

Mkba=f1ab+f2ab+f3ab;
end

% Magnification factor for c - Membrane only "M_kmc"
if acheck<0.125
    Mkmc = 1;
else
    g1c=0.0078157.*(1./a_c).^2-0.070664.*(1./a_c)+1.8508;
    g2c=-0.000054546.*(L_T).^2+0.00013651.*(L_T)-0.00047844;
    g3c=0.00049192.*(L_T).^2-0.0013595.*(L_T)+0.0114;
    g4c=0.0071654.*(L_T).^2-0.033399.*(L_T)-0.25064;
    g5c=-0.018640.*(1./a_c).^2+0.24311.*(1./a_c)-1.7644;
    g6c=-0.0016713.*(L_T).^2+0.009062.*(L_T)-0.016479;
    g7c=-0.0031615.*(L_T).^2-0.010944.*(L_T)+0.13967;
    g8c=-0.045206.*(L_T).^3+0.32380.*(L_T).^2-0.68935.*(L_T)+1.4954;

f1c=g1c.*(a_T).^(g2c.*(1./a_c).^2+g3c.*(1./a_c)+g4c)+g5c.*(1-a_T).^(g6c.*(1./a_c).^2+g7c.*(1./a_c)+g8c);

    g9c=-0.25473.*(a_c).^2+0.40928.*(a_c)+0.0021892;
    g10c=37.423.*(a_c).^2-15.741.*(a_c)+64.903;

f2c=(-0.28639.*a_c.^2+0.35411.*a_c+1.643).*(a_T.^g9c)+0.27449.*(1-a_T).^g10c;

    g11c=-0.10553.*(L_T).^3+0.59894.*(L_T).^2-1.0942.*(L_T)-1.265;
    g12c=0.043891.*(L_T).^3-0.24898.*(L_T).^2+0.44732.*(L_T)+0.60136;
    g13c=-0.011411.*a_c.^2+0.00437.*a_c+0.51732;

f3c=g11c.*a_T.^0.75429+g12c.*exp(a_T.^g13c);

Mkmc=f1c.*f2c.*f3c;
end

% Magnification factor for c - Bending only "M_kbc"
if acheck<0.125
    Mkbc = 1;
else
    g1cb=0.0023232.*(1./a_c).^2-0.00037156.*(1./a_c)+4.5985;
    g2cb=-0.000044010.*(L_T).^2+0.00014425.*(L_T)-0.00086706;
    g3cb=0.00039951.*(L_T).^2-0.0013715.*(L_T)+0.014251;
    g4cb=0.0046169.*(L_T).^2-0.017917.*(L_T)-0.16335;
    g5cb=-0.018524.*(1./a_c).^2+0.27810.*(1./a_c)-5.4253;
    g6cb=-0.00037981.*(L_T).^2+0.0025078.*(L_T)+0.00014693;
    g7cb=-0.0038508.*(L_T).^2+0.0023212.*(L_T)-0.026862;
    g8cb=-0.011911.*(L_T).^3+0.082625.*(L_T).^2-0.16086.*(L_T)+1.2302;
    g9cb=0.27798.*(a_T).^3-1.2144.*(a_T).^2-2.468.*(a_T)+0.099981;

f1cb=g1cb.*(a_T).^(g2cb.*(1./a_c).^2+g3cb.*(1./a_c)+g4cb)+g5cb.*(1-a_T).^(g6cb.*(1./a_c).^2+g7cb.*(1./a_c)+g8cb)+g9cb;

    g10cb=-0.25922.*(a_c).^2+0.39566.*(a_c)+0.011759;
    g11cb=6.5974.*(a_c).^2+55.787.*(a_c)+37.053;

f2cb=(-0.35006.*a_c.^2+0.40768.*a_c+1.7053).*(a_T.^g10cb)+0.24988.*(1-a_T).^g11cb;

    g12cb=-0.14895.*(L_T).^3+0.81526.*(L_T).^2-1.4795.*(L_T)-0.89808;
    g13cb=0.055459.*(L_T).^3-0.3018.*(L_T).^2+0.54154.*(L_T)+0.53433;
    g14cb=-0.01343.*a_c.^2-0.0066702.*a_c+0.75939;

f3cb=g12cb.*a_T.^0.94761+g13cb.*exp(a_T.^g14cb);

Mkbc=f1cb.*f2cb.*f3cb;
end

% Geometric function for a - Membrane only "Y_ma"

if a_2c<=0.5
M1a=1.13-0.09.*(a_c);
M2a=0.89./(0.2+a_c)-0.54;
M3a=0.5-1./(0.65+a_c)+14.*((1-a_c).^24);
f_tha=1;
epsa=(1+1.464.*(a_c.^1.65)).^0.5;
else
M1a=((1./a_c).^0.5).*(1+0.04.*(1./a_c));
M2a=0.2.*(1./a_c).^4;
M3a=-0.11.*((1./a_c).^4);
f_tha=(1./a_c).^0.5;
epsa=(1+1.464.*((1./a_c).^1.65)).^0.5;
end

ga=1;
Yma=(M1a+M2a.*(a_T).^2+M3a.*a_T.^4).*ga.*f_tha./epsa;

% Geometric function for a - Bending only "Y_ba"

if a_2c<=0.5
G1=-1.22-0.12.*a_c;
G2=0.55-1.05.*(a_c).^(0.75)+0.47.*(a_c).^(1.5);
else
G1=-2.11+0.77.*(1./a_c);
G2=0.55-0.72.*(1./a_c).^(0.75)+0.14.*(1./a_c).^(1.5);
end

Hba=1+G1.*(a_T)+G2.*(a_T).^2;
Yba=Hba.*Yma;

% Geometric function for c - Membrane only "Y_mc"

if a_2c<=0.5
M1c=1.13-0.09.*(a_c);
M2c=0.89./(0.2+a_c)-0.54;
M3c=0.5-1./(0.65+a_c)+14.*((1-a_c).^24);
f_thc=a_c.^0.5;
epsc=(1+1.464.*(a_c.^1.65)).^0.5;
gc=1.1+0.35.*(a_T).^2;
else
M1c=((1./a_c).^0.5).*(1+0.04.*(1./a_c));
M2c=0.2.*(1./a_c).^4;
M3c=-0.11.*((1./a_c).^4);
f_thc=1;
epsc=(1+1.464.*((1./a_c).^1.65)).^0.5;
gc=1.1+0.35.*(1./a_c).*(a_T).^2;
end

Ymc=(M1c+M2c.*(a_T).^2+M3c.*a_T.^4).*gc.*f_thc./epsc;

% Geometric function for a - Bending only "Y_bc"

if a_2c<=0.5
H1=1-0.34.*a_T-0.11.*a_c.*a_T;
else
H1=1-(0.04+0.41.*(1./a_c)).*a_T+(0.55-1.93.*(1./a_c).^0.75+1.38.*(1./a_c).^1.5).*(a_T).^2;
end
Ybc=H1.*Ymc;

